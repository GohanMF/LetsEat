angular.module("angularCharts",["angularChartsTemplates"]);angular.module("angularCharts").directive("acChart",["$templateCache","$compile","$rootElement","$window","$timeout","$sce",function(n,t,i,r,u,f){function o(){for(var i="0123456789ABC".split(""),n="#",t=0;t<6;t++)n+=i[Math.round(Math.random()*12)];return n}function e(n,t){var i=null;for(var r in n)if(angular.isElement(n[r])&&(i=angular.element(n[r]),i.hasClass(t)))return i;return i}function s(i,s){function ft(){lt();ht();ct();var n=at(y);n();kt()}function ht(){if(!h.legend.display){c=w;a=p;return}switch(h.legend.position){case"top":case"bottom":c=w*.75;a=p;break;case"left":case"right":c=w;a=p*.75}}function ct(){var u=n.get("angularChartsTemplate_"+h.legend.position),r;s.html(u);t(s.contents())(i);r=s.find("div");k=e(r,"ac-chart");st=e(r,"ac-legend");c-=e(r,"ac-title")[0].clientHeight}function lt(){d=i.acData;y=i.acChart;b=d?d.series||[]:[];l=d?d.data||[]:[];i.acConfig&&angular.extend(h,i.acConfig)}function at(n){var t={pie:wt,bar:vt,line:yt,area:pt,point:bt};return t[n]}function g(n,t){var i=t.domain(),r;h.xAxisMaxTicks&&i.length>h.xAxisMaxTicks&&(r=Math.ceil(i.length/h.xAxisMaxTicks),n.tickValues(i.filter(function(n,t){return t%r==0})))}function vt(){var n={top:0,right:20,bottom:30,left:40},s,w,y,d,u,p,o;a-=n.left+n.right;c-=n.top+n.bottom;var r=d3.scale.ordinal().rangeRoundBands([0,a],.1),t=d3.scale.linear().range([c,10]),f=d3.scale.ordinal().rangeRoundBands([0,a],.1),e=[0];l.forEach(function(n){n.nicedata=n.y.map(function(t,i){return e.push(t),{x:n.x,y:t,s:i,tooltip:angular.isArray(n.tooltip)?n.tooltip[i]:n.tooltip}})});s=d3.max(l.map(function(n){return n.y.length}));i.yMaxData=s;r.domain(l.map(function(n){return n.x}));w=d3.max(e)*.2;t.domain([d3.min(e),d3.max(e)+w]);f.domain(d3.range(s)).rangeRoundBands([0,r.rangeBand()]);y=d3.svg.axis().scale(r).orient("bottom");g(y,r);d=d3.svg.axis().scale(t).orient("left").ticks(10).tickFormat(d3.format("s"));u=d3.select(k[0]).append("svg").attr("width",a+n.left+n.right).attr("height",c+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")");u.append("g").attr("class","x axis").attr("transform","translate(0,"+c+")").call(y);u.append("g").attr("class","y axis").call(d);p=u.selectAll(".state").data(l).enter().append("g").attr("class","g").attr("transform",function(n){return"translate("+r(n.x)+",0)"});o=p.selectAll("rect").data(function(n){return n.nicedata}).enter().append("rect");o.attr("width",f.rangeBand());o.attr("x",function(n,t){return f(t)}).attr("y",c).style("fill",function(n){return v(n.s)}).attr("height",0).transition().ease("cubic-in-out").duration(h.isAnimate?1e3:0).attr("y",function(n){return t(Math.max(0,n.y))}).attr("height",function(n){return Math.abs(t(n.y)-t(0))});o.on("mouseover",function(n){nt({index:n.x,value:n.tooltip?n.tooltip:n.y,series:b[n.s]},d3.event);h.mouseover(n,d3.event);i.$apply()}).on("mouseleave",function(n){tt();h.mouseout(n,d3.event);i.$apply()}).on("mousemove",function(n){it(n,d3.event)}).on("click",function(n){h.click.call(n,d3.event);i.$apply()});h.labels&&p.selectAll("not-a-class").data(function(n){return n.nicedata}).enter().append("text").attr("x",function(n,t){return f(t)}).attr("y",function(n){return c-Math.abs(t(n.y)-t(0))}).text(function(n){return n.y});u.append("line").attr("x1",a).attr("y1",t(0)).attr("y2",t(0)).style("stroke","silver")}function yt(){function f(n){return Math.round(e(n))+e.rangeBand()/2}var n={top:0,right:40,bottom:20,left:40},p,u,ft,w,d,s,y;a-=n.left+n.right;c-=n.top+n.bottom;var e=d3.scale.ordinal().domain(l.map(function(n){return n.x})).rangeRoundBands([0,a]),r=d3.scale.linear().range([c,10]),rt=d3.svg.axis().scale(e).orient("bottom");g(rt,e);var et=d3.svg.axis().scale(r).orient("left").ticks(5).tickFormat(d3.format("s")),ut=d3.svg.line().interpolate(h.lineCurveType).x(function(n){return f(n.x)}).y(function(n){return r(n.y)}),o=[0],t=[];return l.forEach(function(n){n.y.map(function(n){o.push(n)})}),p=d3.max(l.map(function(n){return n.y.length})),i.yMaxData=p,b.slice(0,p).forEach(function(n,i){var r={};r.series=n;r.values=l.map(function(n){return n.y.map(function(t){return{x:n.x,y:t,tooltip:n.tooltip}})[i]||{x:l[i].x,y:0}});t.push(r)}),u=d3.select(k[0]).append("svg").attr("width",a+n.left+n.right).attr("height",c+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")"),ft=d3.max(o)*.2,r.domain([d3.min(o),d3.max(o)+ft]),u.append("g").attr("class","x axis").attr("transform","translate(0,"+c+")").call(rt),u.append("g").attr("class","y axis").call(et),w=u.selectAll(".points").data(t).enter().append("g"),d=w.attr("points","points").append("path").attr("class","ac-line").style("stroke",function(n,t){return v(t)}).attr("d",function(n){return ut(n.values)}).attr("stroke-width","2").attr("fill","none"),t.length>0&&(s=t[t.length-1].values,s.length>0&&(y=d.node().getTotalLength()+f(s[s.length-1].x),d.attr("stroke-dasharray",y+" "+y).attr("stroke-dashoffset",y).transition().duration(h.isAnimate?1500:0).ease("linear").attr("stroke-dashoffset",0).attr("d",function(n){return ut(n.values)}))),angular.forEach(t,function(n){var e=u.selectAll(".circle").data(n.values).enter();e.append("circle").attr("cx",function(n){return f(n.x)}).attr("cy",function(n){return r(n.y)}).attr("r",3).style("fill",v(t.indexOf(n))).style("stroke",v(t.indexOf(n))).on("mouseover",function(n){return function(t){nt({index:t.x,value:t.tooltip?t.tooltip:t.y,series:n},d3.event);h.mouseover(t,d3.event);i.$apply()}}(n.series)).on("mouseleave",function(n){tt();h.mouseout(n,d3.event);i.$apply()}).on("mousemove",function(){it(d3.event)}).on("click",function(n){h.click(n,d3.event);i.$apply()});h.labels&&e.append("text").attr("x",function(n){return f(n.x)}).attr("y",function(n){return r(n.y)}).text(function(n){return n.y})}),h.lineLegend==="lineEnd"&&w.append("text").datum(function(n){return{name:n.series,value:n.values[n.values.length-1]}}).attr("transform",function(n){return"translate("+f(n.value.x)+","+r(n.value.y)+")"}).attr("x",3).text(function(n){return n.name}),t}function pt(){function nt(n){return Math.round(u(n))+u.rangeBand()/2}var n={top:0,right:40,bottom:20,left:40},y,r,e,o,f,p,w,d;a-=n.left+n.right;c-=n.top+n.bottom;var u=d3.scale.ordinal().domain(l.map(function(n){return n.x})).rangePoints([0,a]),t=d3.scale.linear().range([c,10]),s=d3.svg.axis().scale(u).orient("bottom");g(s,u);y=d3.svg.axis().scale(t).orient("left").ticks(5).tickFormat(d3.format("s"));d3.svg.line().interpolate(h.lineCurveType).x(function(n){return nt(n.x)}).y(function(n){return t(n.y)});r=[0];e=[];l.forEach(function(n){n.y.map(function(n){r.push(n)})});o=d3.max(l.map(function(n){return n.y.length}));i.yMaxData=o;b.slice(0,o).forEach(function(n,t){var i={};i.series=n;i.values=l.map(function(n){return n.y.map(function(t){return{x:n.x,y:t}})[t]||{x:l[t].x,y:0}});e.push(i)});f=d3.select(k[0]).append("svg").attr("width",a+n.left+n.right).attr("height",c+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")");p=d3.max(r)*.2;t.domain([d3.min(r),d3.max(r)+p]);f.append("g").attr("class","x axis").attr("transform","translate(0,"+c+")").call(s);f.append("g").attr("class","y axis").call(y);w=f.selectAll(".points").data(e).enter().append("g");d=d3.svg.area().interpolate("basis").x(function(n){return nt(n.x)}).y0(function(){return t(0)}).y1(function(n){return t(0+n.y)});w.append("path").attr("class","area").attr("d",function(n){return d(n.values)}).style("fill",function(n,t){return v(t)}).style("opacity","0.7")}function wt(){function y(n){n.innerRadius=0;var t=d3.interpolate({startAngle:0,endAngle:0},n);return function(n){return r(t(n))}}var t=Math.min(a,c)/2,o=d3.select(k[0]).append("svg").attr("width",a).attr("height",c).append("g").attr("transform","translate("+a/2+","+c/2+")"),f=0,n,r;h.innerRadius&&(n=h.innerRadius,n=typeof n=="string"&&n.indexOf("%")>0?t*parseFloat(n)*.01:Number(n),n>=0&&(f=n));i.yMaxData=l.length;r=d3.svg.arc().outerRadius(t-10).innerRadius(f);d3.svg.arc().outerRadius(t+5).innerRadius(0);var s=d3.layout.pie().sort(null).value(function(n){return n.y[0]}),u=o.selectAll(".arc").data(s(l)).enter().append("g"),e=!1;u.append("path").style("fill",function(n,t){return v(t)}).transition().ease("linear").duration(h.isAnimate?500:0).attrTween("d",y).attr("class","arc").each("end",function(){if(!e){e=!0;u.on("mouseover",function(n){nt({value:n.data.tooltip?n.data.tooltip:n.data.y[0]},d3.event);d3.select(this).select("path").transition().duration(200).style("stroke","white").style("stroke-width","2px");h.mouseover(n,d3.event);i.$apply()}).on("mouseleave",function(n){d3.select(this).select("path").transition().duration(200).style("stroke","").style("stroke-width","");tt();h.mouseout(n,d3.event);i.$apply()}).on("mousemove",function(n){it(n,d3.event)}).on("click",function(n){h.click(n,d3.event);i.$apply()})}});!h.labels||u.append("text").attr("transform",function(n){return"translate("+r.centroid(n)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(n){return n.data.y[0]})}function bt(){function p(n){return Math.round(u(n))+u.rangeBand()/2}var n={top:0,right:40,bottom:20,left:40},o,r,y;a-=n.left-n.right;c-=n.top-n.bottom;var u=d3.scale.ordinal().domain(l.map(function(n){return n.x})).rangeRoundBands([0,a]),f=d3.scale.linear().range([c,10]),s=d3.svg.axis().scale(u).orient("bottom");g(s,u);var w=d3.svg.axis().scale(f).orient("left").ticks(5).tickFormat(d3.format("s")),e=[0],t=[];l.forEach(function(n){n.y.map(function(n){e.push(n)})});o=d3.max(l.map(function(n){return n.y.length}));i.yMaxPoints=o;b.slice(0,o).forEach(function(n,i){var r={};r.series=n;r.values=l.map(function(n){return n.y.map(function(t){return{x:n.x,y:t}})[i]||{x:l[i].x,y:0}});t.push(r)});r=d3.select(k[0]).append("svg").attr("width",a+n.left+n.right).attr("height",c+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")");y=d3.max(e)*.2;f.domain([d3.min(e),d3.max(e)+y]);r.append("g").attr("class","x axis").attr("transform","translate(0,"+c+")").call(s);r.append("g").attr("class","y axis").call(w);r.selectAll(".points").data(t).enter().append("g");angular.forEach(t,function(n){var u=r.selectAll(".circle").data(n.values).enter();u.append("circle").attr("cx",function(n){return p(n.x)}).attr("cy",function(n){return f(n.y)}).attr("r",3).style("fill",v(t.indexOf(n))).style("stroke",v(t.indexOf(n))).on("mouseover",function(n){return function(t){nt({index:t.x,value:t.tooltip?t.tooltip:t.y,series:n},d3.event);h.mouseover(t,d3.event);i.$apply()}}(n.series)).on("mouseleave",function(n){tt();h.mouseout(n,d3.event);i.$apply()}).on("mousemove",function(){it(d3.event)}).on("click",function(n){h.click(n,d3.event);i.$apply()});h.labels&&u.append("text").attr("x",function(n){return p(n.x)}).attr("y",function(n){return f(n.y)}).text(function(n){return n.y})})}function nt(n,t){if(h.tooltips){n=typeof h.tooltips=="function"?h.tooltips(n):n.value;var r=angular.element('<p class="ac-tooltip"><\/p>').html(n).css({left:t.pageX+20+"px",top:t.pageY-30+"px"});angular.element(document.querySelector(".ac-tooltip")).remove();angular.element(document.body).append(r);i.$tooltip=r}}function tt(){i.$tooltip&&i.$tooltip.remove()}function it(n){i.$tooltip&&i.$tooltip.css({left:n.pageX+20+"px",top:n.pageY-30+"px"})}function kt(){i.legends=[];y==="pie"&&angular.forEach(l,function(n,t){i.legends.push({color:h.colors[t],title:ot(n.x)})});(y==="bar"||y==="area"||y==="point"||y==="line"&&h.lineLegend==="traditional")&&angular.forEach(b,function(n,t){i.legends.push({color:h.colors[t],title:ot(n)})})}function dt(n){return String(n).replace(/[&<>"'\/]/g,function(n){return et[n]})}function ot(n){return f.trustAsHtml(h.legend.htmlEnabled?n:dt(n))}function v(n){if(n<h.colors.length)return h.colors[n];var t=o();return h.colors.push(t),t}var h={title:"",tooltips:!0,labels:!1,mouseover:function(){},mouseout:function(){},click:function(){},legend:{display:!0,position:"left",htmlEnabled:!1},colors:[],innerRadius:0,lineLegend:"lineEnd",lineCurveType:"cardinal",isAnimate:!0},p=s[0].clientWidth,w=s[0].clientHeight,d,b,l,c,a,k,st,y,et,rt,ut;if(w===0||p===0)throw new Error("Please set height and width for the chart element");et={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};rt=angular.element(r);ut=null;rt.bind("resize",function(){ut&&u.cancel(ut);ut=u(function(){p=s[0].clientWidth;w=s[0].clientHeight;ft()},100)});i.getWindowDimensions=function(){return{h:rt[0].clientHeight,w:rt[0].clientWidth}};i.$watch("[acChart, acData, acConfig]",ft,!0);i.$watch(function(){return{w:s[0].clientWidth,h:s[0].clientHeight}},function(n){p=n.w;w=n.h;ft()},!0)}return{restrict:"EA",link:s,transclude:"true",scope:{acChart:"=",acData:"=",acConfig:"="}}}]),function(){var t=".angular-charts-template .axis path,.angular-charts-template .axis line{fill:none;stroke:#333}.angular-charts-template .ac-title{font-weight:700;font-size:1.2em}.angular-charts-template .ac-chart{float:left;width:75%}.angular-charts-template .ac-line{fill:none;stroke-width:2px}.angular-charts-template table{float:left;max-width:25%;list-style:none;margin:0;padding:0}.angular-charts-template td[ng-bind]{display:inline-block}.angular-charts-template .ac-legend-box{border-radius:5px;height:15px;width:15px}.ac-tooltip{display:block;position:absolute;border:2px solid rgba(51,51,51,.9);background-color:rgba(22,22,22,.7);border-radius:5px;padding:5px;color:#fff}",n=document.createElement("style");if(document.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=t);else try{n.innerHTML=t}catch(i){n.innerText=t}}();angular.module("angularChartsTemplates",["angularChartsTemplate_left","angularChartsTemplate_right"]);angular.module("angularChartsTemplate_left",[]).run(["$templateCache",function(n){n.put("angularChartsTemplate_left",'<div class="angular-charts-template"><div class="ac-title">{{acConfig.title}}<\/div><div class="ac-legend" ng-show="{{acConfig.legend.display}}"><div ng-repeat="l in legends" class="ac-legend-box" ng-attr-style="background-color:{{l.color}};" ng-bind-html="l.title"><\/div><\/div><div class="ac-chart"><\/div><\/div>')}]);angular.module("angularChartsTemplate_right",[]).run(["$templateCache",function(n){n.put("angularChartsTemplate_right",'<div class="angular-charts-template"><div class="ac-title">{{acConfig.title}}<\/div><div class="ac-chart"><\/div><div class="ac-legend" ng-show="{{acConfig.legend.display}}"><table><tr ng-repeat="l in legends | limitTo:yMaxData"><td><div class="ac-legend-box" ng-attr-style="background:{{l.color}};"><\/div><\/td><td ng-bind-html="l.title"><\/td><\/tr><\/table><\/div><\/div>')}]);
//# sourceMappingURL=angular-charts.min.js.map
